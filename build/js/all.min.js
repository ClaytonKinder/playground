"use strict";function getRandomArrayEntry(e){return e[Math.floor(Math.random()*e.length)]}function buildClueHints(e,t){var n=[];return e.forEach(function(e){"beginsWith"==e.key?e.finalSentence=e.sentence+t.charAt(0).toUpperCase()+".":"endsWith"==e.key?e.finalSentence=e.sentence+t.substr(-1).toUpperCase()+".":"length"==e.key&&(e.finalSentence=e.sentence+t.length+" characters."),n.push(e.finalSentence)}),n}function buildClues(e,t){var n=[];for(n[0]=getRandomArrayEntry(e),n[1]=getRandomArrayEntry(e);n[0]===n[1];)n[1]=getRandomArrayEntry(e);chosenClues=buildClueHints(n,t)}function showCategory(e){dom.categoryText.classList.remove("chosen");var t=[].concat(categories),n={totalTime:500,totalIterations:5,currentIteration:0,catIndex:0},r=(categories.findIndex(function(t){return t===e}),setInterval(function(){n.catIndex>t.length-1&&(n.catIndex=0),n.currentIteration>n.totalIterations&&t[n.catIndex]===e&&(clearInterval(r),gameOn=!0,dom.categoryText.classList.add("chosen")),dom.categoryText.textContent=t[n.catIndex],n.currentIteration++,n.catIndex++},n.totalTime/t.length))}function handleGameOver(e){gameOn=!1,e?(dom.inputForm.classList.add("hide"),dom.winScreen.classList.remove("hide"),currentWinStreak++,dom.currentWinStreak.textContent=currentWinStreak,currentWinStreak>bestWinStreak&&localStorage.setItem("bestWinStreak",currentWinStreak)):(dom.inputForm.classList.add("hide"),dom.loseScreen.classList.remove("hide"),currentWinStreak=0)}function verifyGuess(e){(e=e.toLowerCase().replace(/\s/g,""))!==answerObj.strippedAnswer?(incorrectAnswers.current++,incorrectAnswers.current===incorrectAnswers.total?(markGuessResults(incorrectAnswers.current),handleGameOver(!1)):(markGuessResults(incorrectAnswers.current),giveClue())):(markGuessResults(incorrectAnswers.current++,!0),handleGameOver(!0))}function giveClue(){var e=document.createElement("div");e.textContent=chosenClues.splice(0,1),dom.clues.appendChild(e)}function markGuessResults(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];dom.guessResults.forEach(function(e){e.dataset.guess==incorrectAnswers.current&&(t?e.classList.add("correct"):e.classList.add("incorrect"))})}function clearGuessResults(){dom.guessResults.forEach(function(e){e.classList.remove("correct"),e.classList.remove("incorrect")})}function handleGuessInput(e){e.preventDefault(),gameOn&&0!=dom.textInput.value.trim().length&&(verifyGuess(dom.textInput.value),dom.inputForm.reset())}function resetGuess(){gameOn=!1,bestWinStreak=localStorage.getItem("bestWinStreak")||0,category=getRandomArrayEntry(categories),dom.currentWinStreak.textContent=currentWinStreak,dom.bestWinStreak.textContent=bestWinStreak,dom.clues.innerHTML="",incorrectAnswers.current=0,clearGuessResults(),dom.inputForm.classList.remove("hide"),dom.winScreen.classList.add("hide"),dom.loseScreen.classList.add("hide"),dom.textInput.focus();var e=fetch("./json/clues.json").then(function(e){return e.json()}).then(function(e){return e.entries}),t=fetch("./json/"+category+".json").then(function(e){return e.json()}).then(function(e){return e.entries});Promise.all([t,e]).then(function(e){dom.inputForm.reset(),entries=e[0],answerObj.trueAnswer=entries[Math.floor(Math.random()*entries.length)],answerObj.strippedAnswer=answerObj.trueAnswer.replace(/\s/g,"").toLowerCase(),buildClues(allClues=e[1],answerObj.strippedAnswer),showCategory(category)})}function checkForReset(e){13!==e.keyCode||gameOn||resetGuess()}var categories=["fruits","vegetables","pizza-toppings"],entries=[],answerObj={},allClues=void 0,chosenClues=[],category=getRandomArrayEntry(categories),gameOn=void 0,currentWinStreak=0,bestWinStreak=void 0,incorrectAnswers={total:3,current:0},dom={bestWinStreak:document.querySelector(".guess .best-win-streak .value"),currentWinStreak:document.querySelector(".guess .current-win-streak .value"),categoryText:document.querySelector(".guess .category-text"),inputForm:document.querySelector('.guess form[name="guess-form"]'),textInput:document.querySelector('.guess form[name="guess-form"] input[type="text"]'),guessResults:document.querySelectorAll(".guess [data-guess]"),clues:document.querySelector(".guess .clue-text"),winScreen:document.querySelector(".guess .win"),loseScreen:document.querySelector(".guess .lose")};dom.inputForm.addEventListener("submit",handleGuessInput),document.addEventListener("guess",resetGuess),document.addEventListener("keydown",checkForReset);
"use strict";function scrollJack(n){isScrolling||(isScrolling=!0,n.deltaY<0?(currentPlayground=playgrounds[currentPlaygroundIndex],currentPlaygroundIndex>0&&currentPlaygroundIndex--,nextPlayground=playgrounds[currentPlaygroundIndex],scrollToCurrentPlayground(!1)):(currentPlayground=playgrounds[currentPlaygroundIndex],currentPlaygroundIndex<playgrounds.length-1&&currentPlaygroundIndex++,nextPlayground=playgrounds[currentPlaygroundIndex],scrollToCurrentPlayground(!0)))}function scrollToCurrentPlayground(n){nextPlayground&&(n?(currentPlayground.classList.add("current"),nextPlayground.classList.add("next-scrolling","sliding"),setTimeout(function(){currentPlayground.classList.remove("current"),nextPlayground.classList.remove("next-scrolling","sliding"),nextPlayground.classList.add("current"),nextPlayground.dataset.playground&&document.dispatchEvent(events[nextPlayground.dataset.playground]),isScrolling=!1},scrollTime)):(nextPlayground.classList.add("up"),currentPlayground.classList.remove("current"),nextPlayground.classList.remove("next-scrolling","sliding"),nextPlayground.classList.add("current"),setTimeout(function(){nextPlayground.classList.remove("up")},10),nextPlayground.dataset.playground&&document.dispatchEvent(events[nextPlayground.dataset.playground]),isScrolling=!1))}function setupCustomEvents(){playgrounds.forEach(function(n){n.dataset.playground&&(events[n.dataset.playground]=new Event(n.dataset.playground))})}var body=document.querySelector("body"),playgrounds=document.querySelectorAll(".playground"),currentPlaygroundIndex=0,currentPlayground=playgrounds[currentPlaygroundIndex],nextPlayground=void 0,scrollTime=600,isScrolling=!1,events={};document.addEventListener("wheel",scrollJack),setupCustomEvents();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImd1ZXNzLmpzIiwicGxheWdyb3VuZC5qcyJdLCJuYW1lcyI6WyJnZXRSYW5kb21BcnJheUVudHJ5IiwiYXJyYXkiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJsZW5ndGgiLCJidWlsZENsdWVIaW50cyIsImNsdWVzIiwiYW5zd2VyIiwiZmluYWxDbHVlcyIsImZvckVhY2giLCJjbHVlIiwia2V5IiwiZmluYWxTZW50ZW5jZSIsInNlbnRlbmNlIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzdWJzdHIiLCJwdXNoIiwiYnVpbGRDbHVlcyIsImFsbENsdWVzIiwidW5maW5pc2hlZENsdWVzIiwiY2hvc2VuQ2x1ZXMiLCJzaG93Q2F0ZWdvcnkiLCJjYXRlZ29yeSIsImRvbSIsImNhdGVnb3J5VGV4dCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImNhdHMiLCJjb25jYXQiLCJjYXRlZ29yaWVzIiwiaXRlcmF0aW9uIiwidG90YWxUaW1lIiwidG90YWxJdGVyYXRpb25zIiwiY3VycmVudEl0ZXJhdGlvbiIsImNhdEluZGV4IiwiY2F0ZWdvcnlJbnRlcnZhbCIsImZpbmRJbmRleCIsImNhdCIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImdhbWVPbiIsImFkZCIsInRleHRDb250ZW50IiwiaGFuZGxlR2FtZU92ZXIiLCJ3aW4iLCJpbnB1dEZvcm0iLCJ3aW5TY3JlZW4iLCJjdXJyZW50V2luU3RyZWFrIiwiYmVzdFdpblN0cmVhayIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJsb3NlU2NyZWVuIiwidmVyaWZ5R3Vlc3MiLCJndWVzcyIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsImFuc3dlck9iaiIsInN0cmlwcGVkQW5zd2VyIiwiaW5jb3JyZWN0QW5zd2VycyIsImN1cnJlbnQiLCJ0b3RhbCIsIm1hcmtHdWVzc1Jlc3VsdHMiLCJnaXZlQ2x1ZSIsImRpdiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNwbGljZSIsImFwcGVuZENoaWxkIiwiY29ycmVjdCIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsImd1ZXNzUmVzdWx0cyIsInJlc3VsdCIsImRhdGFzZXQiLCJjbGVhckd1ZXNzUmVzdWx0cyIsImhhbmRsZUd1ZXNzSW5wdXQiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0ZXh0SW5wdXQiLCJ2YWx1ZSIsInRyaW0iLCJyZXNldCIsInJlc2V0R3Vlc3MiLCJnZXRJdGVtIiwiaW5uZXJIVE1MIiwiZm9jdXMiLCJnZXRDbHVlRGF0YSIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwianNvbiIsImVudHJpZXMiLCJnZXRDYXRlZ29yeURhdGEiLCJQcm9taXNlIiwiYWxsIiwidHJ1ZUFuc3dlciIsImNoZWNrRm9yUmVzZXQiLCJrZXlDb2RlIiwicXVlcnlTZWxlY3RvciIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJhZGRFdmVudExpc3RlbmVyIiwic2Nyb2xsSmFjayIsImlzU2Nyb2xsaW5nIiwiZGVsdGFZIiwiY3VycmVudFBsYXlncm91bmQiLCJwbGF5Z3JvdW5kcyIsImN1cnJlbnRQbGF5Z3JvdW5kSW5kZXgiLCJuZXh0UGxheWdyb3VuZCIsInNjcm9sbFRvQ3VycmVudFBsYXlncm91bmQiLCJpc1Njcm9sbERvd24iLCJzZXRUaW1lb3V0IiwicGxheWdyb3VuZCIsImRpc3BhdGNoRXZlbnQiLCJldmVudHMiLCJzY3JvbGxUaW1lIiwic2V0dXBDdXN0b21FdmVudHMiLCJFdmVudCIsImJvZHkiXSwibWFwcGluZ3MiOiJBQUFBLGFBNEJFLFNBQVNBLG9CQUFvQkMsR0FDN0IsT0FBT0EsRUFBTUMsS0FBS0MsTUFBTUQsS0FBS0UsU0FBV0gsRUFBTUksU0FLaEQsU0FBU0MsZUFBZUMsRUFBT0MsR0FDN0IsSUFBSUMsS0FXSixPQVZBRixFQUFNRyxRQUFRLFNBQVVDLEdBQ04sY0FBWkEsRUFBS0MsSUFDUEQsRUFBS0UsY0FBZ0JGLEVBQUtHLFNBQVdOLEVBQU9PLE9BQU8sR0FBR0MsY0FBZ0IsSUFDakQsWUFBWkwsRUFBS0MsSUFDZEQsRUFBS0UsY0FBZ0JG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ZUFBZWxGLFVBQVVnQixJQUFJLE1BQzdCK0Qsa0JBQWtCL0UsVUFBVUMsT0FBTyxXQUNuQ2lGLGVBQWVsRixVQUFVQyxPQUFPLGlCQUFrQixXQUNsRGlGLGVBQWVsRixVQUFVZ0IsSUFBSSxXQUM3QnFFLFdBQVcsV0FDVEgsZUFBZWxGLFVBQVVDLE9BQU8sT0FDL0IsSUFFQ2lGLGVBQWVsQyxRQUFRc0MsWUFDekIvQyxTQUFTZ0QsY0FBY0MsT0FBT04sZUFBZWxDLFFBQVFzQyxhQUV2RFQsYUFBYyxJQUlsQixTQUFTYSxvQkFDUFYsWUFBWWpHLFFBQVEsU0FBVXVHLEdBQ3hCQSxFQUFXdEMsUUFBUXNDLGFBQ3JCRSxPQUFPRixFQUFXdEMsUUFBUXNDLFlBQWMsSUFBSUssTUFBTUwsRUFBV3RDLFFBQVFzQyxlQS9EM0UsSUFBSU0sS0FBT3JELFNBQVNrQyxjQUFjLFFBQzlCTyxZQUFjekMsU0FBU21DLGlCQUFpQixlQUN4Q08sdUJBQXlCLEVBQ3pCRixrQkFBb0JDLFlBQVlDLHdCQUNoQ0Msb0JBQWlCLEVBQ2pCTyxXQUFhLElBQ2JaLGFBQWMsRUFDZFcsVUE2REpqRCxTQUFTb0MsaUJBQWlCLFFBQVNDLFlBRW5DYyIsImZpbGUiOiJhbGwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgY2F0ZWdvcmllcyA9IFsnZnJ1aXRzJywgJ3ZlZ2V0YWJsZXMnLCAncGl6emEtdG9wcGluZ3MnXTtcbnZhciBlbnRyaWVzID0gW107XG52YXIgYW5zd2VyT2JqID0ge307XG52YXIgYWxsQ2x1ZXMgPSB2b2lkIDA7XG52YXIgY2hvc2VuQ2x1ZXMgPSBbXTtcbnZhciBjYXRlZ29yeSA9IGdldFJhbmRvbUFycmF5RW50cnkoY2F0ZWdvcmllcyk7XG52YXIgZ2FtZU9uID0gdm9pZCAwO1xudmFyIGN1cnJlbnRXaW5TdHJlYWsgPSAwO1xudmFyIGJlc3RXaW5TdHJlYWsgPSB2b2lkIDA7XG52YXIgaW5jb3JyZWN0QW5zd2VycyA9IHtcbiAgdG90YWw6IDMsXG4gIGN1cnJlbnQ6IDBcbn07XG5cbnZhciBkb20gPSB7XG4gIGJlc3RXaW5TdHJlYWs6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ndWVzcyAuYmVzdC13aW4tc3RyZWFrIC52YWx1ZScpLFxuICBjdXJyZW50V2luU3RyZWFrOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3Vlc3MgLmN1cnJlbnQtd2luLXN0cmVhayAudmFsdWUnKSxcbiAgY2F0ZWdvcnlUZXh0OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3Vlc3MgLmNhdGVnb3J5LXRleHQnKSxcbiAgaW5wdXRGb3JtOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3Vlc3MgZm9ybVtuYW1lPVwiZ3Vlc3MtZm9ybVwiXScpLFxuICB0ZXh0SW5wdXQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ndWVzcyBmb3JtW25hbWU9XCJndWVzcy1mb3JtXCJdIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJyksXG4gIGd1ZXNzUmVzdWx0czogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmd1ZXNzIFtkYXRhLWd1ZXNzXScpLFxuICBjbHVlczogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmd1ZXNzIC5jbHVlLXRleHQnKSxcbiAgd2luU2NyZWVuOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3Vlc3MgLndpbicpLFxuICBsb3NlU2NyZWVuOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3Vlc3MgLmxvc2UnKVxuICAvLyBVdGlsaXR5IGZ1bmN0aW9uc1xuXG59O2Z1bmN0aW9uIGdldFJhbmRvbUFycmF5RW50cnkoYXJyYXkpIHtcbiAgcmV0dXJuIGFycmF5W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFycmF5Lmxlbmd0aCldO1xufVxuXG4vLyBDbHVlIGZ1bmN0aW9uc1xuXG5mdW5jdGlvbiBidWlsZENsdWVIaW50cyhjbHVlcywgYW5zd2VyKSB7XG4gIHZhciBmaW5hbENsdWVzID0gW107XG4gIGNsdWVzLmZvckVhY2goZnVuY3Rpb24gKGNsdWUpIHtcbiAgICBpZiAoY2x1ZS5rZXkgPT0gJ2JlZ2luc1dpdGgnKSB7XG4gICAgICBjbHVlLmZpbmFsU2VudGVuY2UgPSBjbHVlLnNlbnRlbmNlICsgYW5zd2VyLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgJy4nO1xuICAgIH0gZWxzZSBpZiAoY2x1ZS5rZXkgPT0gJ2VuZHNXaXRoJykge1xuICAgICAgY2x1ZS5maW5hbFNlbnRlbmNlID0gY2x1ZS5zZW50ZW5jZSArIGFuc3dlci5zdWJzdHIoLTEpLnRvVXBwZXJDYXNlKCkgKyAnLic7XG4gICAgfSBlbHNlIGlmIChjbHVlLmtleSA9PSAnbGVuZ3RoJykge1xuICAgICAgY2x1ZS5maW5hbFNlbnRlbmNlID0gY2x1ZS5zZW50ZW5jZSArIGFuc3dlci5sZW5ndGggKyAnIGNoYXJhY3RlcnMuJztcbiAgICB9XG4gICAgZmluYWxDbHVlcy5wdXNoKGNsdWUuZmluYWxTZW50ZW5jZSk7XG4gIH0pO1xuICByZXR1cm4gZmluYWxDbHVlcztcbn1cblxuZnVuY3Rpb24gYnVpbGRDbHVlcyhhbGxDbHVlcywgYW5zd2VyKSB7XG4gIHZhciB1bmZpbmlzaGVkQ2x1ZXMgPSBbXTtcbiAgdW5maW5pc2hlZENsdWVzWzBdID0gZ2V0UmFuZG9tQXJyYXlFbnRyeShhbGxDbHVlcyk7XG4gIHVuZmluaXNoZWRDbHVlc1sxXSA9IGdldFJhbmRvbUFycmF5RW50cnkoYWxsQ2x1ZXMpO1xuICB3aGlsZSAodW5maW5pc2hlZENsdWVzWzBdID09PSB1bmZpbmlzaGVkQ2x1ZXNbMV0pIHtcbiAgICB1bmZpbmlzaGVkQ2x1ZXNbMV0gPSBnZXRSYW5kb21BcnJheUVudHJ5KGFsbENsdWVzKTtcbiAgfVxuICBjaG9zZW5DbHVlcyA9IGJ1aWxkQ2x1ZUhpbnRzKHVuZmluaXNoZWRDbHVlcywgYW5zd2VyKTtcbn1cblxuLy8gQ2F0ZWdvcnkgZnVuY3Rpb25zXG5mdW5jdGlvbiBzaG93Q2F0ZWdvcnkoY2F0ZWdvcnkpIHtcbiAgZG9tLmNhdGVnb3J5VGV4dC5jbGFzc0xpc3QucmVtb3ZlKCdjaG9zZW4nKTtcbiAgdmFyIGNhdHMgPSBbXS5jb25jYXQoY2F0ZWdvcmllcyk7XG4gIHZhciBpdGVyYXRpb24gPSB7XG4gICAgdG90YWxUaW1lOiA1MDAsXG4gICAgdG90YWxJdGVyYXRpb25zOiA1LFxuICAgIGN1cnJlbnRJdGVyYXRpb246IDAsXG4gICAgY2F0SW5kZXg6IDBcbiAgfTtcbiAgdmFyIGZpbmFsQ2F0ZWdvcnlJbmRleCA9IGNhdGVnb3JpZXMuZmluZEluZGV4KGZ1bmN0aW9uIChjYXQpIHtcbiAgICByZXR1cm4gY2F0ID09PSBjYXRlZ29yeTtcbiAgfSk7XG4gIHZhciBjYXRlZ29yeUludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgIGlmIChpdGVyYXRpb24uY2F0SW5kZXggPiBjYXRzLmxlbmd0aCAtIDEpIHtcbiAgICAgIGl0ZXJhdGlvbi5jYXRJbmRleCA9IDA7XG4gICAgfVxuICAgIGlmIChpdGVyYXRpb24uY3VycmVudEl0ZXJhdGlvbiA+IGl0ZXJhdGlvbi50b3RhbEl0ZXJhdGlvbnMpIHtcbiAgICAgIGlmIChjYXRzW2l0ZXJhdGlvbi5jYXRJbmRleF0gPT09IGNhdGVnb3J5KSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoY2F0ZWdvcnlJbnRlcnZhbCk7XG4gICAgICAgIGdhbWVPbiA9IHRydWU7XG4gICAgICAgIGRvbS5jYXRlZ29yeVRleHQuY2xhc3NMaXN0LmFkZCgnY2hvc2VuJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGRvbS5jYXRlZ29yeVRleHQudGV4dENvbnRlbnQgPSBjYXRzW2l0ZXJhdGlvbi5jYXRJbmRleF07XG4gICAgaXRlcmF0aW9uLmN1cnJlbnRJdGVyYXRpb24rKztcbiAgICBpdGVyYXRpb24uY2F0SW5kZXgrKztcbiAgfSwgaXRlcmF0aW9uLnRvdGFsVGltZSAvIGNhdHMubGVuZ3RoKTtcbn1cblxuLy8gSW5wdXRcblxuZnVuY3Rpb24gaGFuZGxlR2FtZU92ZXIod2luKSB7XG4gIGdhbWVPbiA9IGZhbHNlO1xuICBpZiAod2luKSB7XG4gICAgZG9tLmlucHV0Rm9ybS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgZG9tLndpblNjcmVlbi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gICAgY3VycmVudFdpblN0cmVhaysrO1xuICAgIGRvbS5jdXJyZW50V2luU3RyZWFrLnRleHRDb250ZW50ID0gY3VycmVudFdpblN0cmVhaztcbiAgICBpZiAoY3VycmVudFdpblN0cmVhayA+IGJlc3RXaW5TdHJlYWspIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdiZXN0V2luU3RyZWFrJywgY3VycmVudFdpblN0cmVhayk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGRvbS5pbnB1dEZvcm0uY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICAgIGRvbS5sb3NlU2NyZWVuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICBjdXJyZW50V2luU3RyZWFrID0gMDtcbiAgfVxufVxuXG5mdW5jdGlvbiB2ZXJpZnlHdWVzcyhndWVzcykge1xuICBndWVzcyA9IGd1ZXNzLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzL2csICcnKTtcbiAgLy8gSWYgZ3Vlc3MgaXMgaW5jb3JyZWN0XG4gIGlmIChndWVzcyAhPT0gYW5zd2VyT2JqLnN0cmlwcGVkQW5zd2VyKSB7XG4gICAgaW5jb3JyZWN0QW5zd2Vycy5jdXJyZW50Kys7XG4gICAgLy8gSWYgdXNlciBoYXMgZW5vdWdoIGluY29ycmVjdCBndWVzc2VzIGZvciBhIGdhbWUgb3ZlclxuICAgIGlmIChpbmNvcnJlY3RBbnN3ZXJzLmN1cnJlbnQgPT09IGluY29ycmVjdEFuc3dlcnMudG90YWwpIHtcbiAgICAgIG1hcmtHdWVzc1Jlc3VsdHMoaW5jb3JyZWN0QW5zd2Vycy5jdXJyZW50KTtcbiAgICAgIGhhbmRsZUdhbWVPdmVyKGZhbHNlKTtcbiAgICAgIC8vIElmIHVzZXIgZG9lcyBOT1QgaGF2ZSBlbm91Z2ggaW5jb3JyZWN0IGd1ZXNzZXMgZm9yIGEgZ2FtZSBvdmVyXG4gICAgfSBlbHNlIHtcbiAgICAgIG1hcmtHdWVzc1Jlc3VsdHMoaW5jb3JyZWN0QW5zd2Vycy5jdXJyZW50KTtcbiAgICAgIGdpdmVDbHVlKCk7XG4gICAgfVxuICAgIC8vIElmIGd1ZXNzIGlzIGNvcnJlY3RcbiAgfSBlbHNlIHtcbiAgICBtYXJrR3Vlc3NSZXN1bHRzKGluY29ycmVjdEFuc3dlcnMuY3VycmVudCsrLCB0cnVlKTtcbiAgICBoYW5kbGVHYW1lT3Zlcih0cnVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnaXZlQ2x1ZSgpIHtcbiAgdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICBkaXYudGV4dENvbnRlbnQgPSBjaG9zZW5DbHVlcy5zcGxpY2UoMCwgMSk7XG4gIGRvbS5jbHVlcy5hcHBlbmRDaGlsZChkaXYpO1xufVxuXG5mdW5jdGlvbiBtYXJrR3Vlc3NSZXN1bHRzKGN1cnJlbnQpIHtcbiAgdmFyIGNvcnJlY3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlO1xuXG4gIGRvbS5ndWVzc1Jlc3VsdHMuZm9yRWFjaChmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgaWYgKHJlc3VsdC5kYXRhc2V0Lmd1ZXNzID09IGluY29ycmVjdEFuc3dlcnMuY3VycmVudCkge1xuICAgICAgaWYgKGNvcnJlY3QpIHtcbiAgICAgICAgcmVzdWx0LmNsYXNzTGlzdC5hZGQoJ2NvcnJlY3QnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdC5jbGFzc0xpc3QuYWRkKCdpbmNvcnJlY3QnKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjbGVhckd1ZXNzUmVzdWx0cygpIHtcbiAgZG9tLmd1ZXNzUmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICByZXN1bHQuY2xhc3NMaXN0LnJlbW92ZSgnY29ycmVjdCcpO1xuICAgIHJlc3VsdC5jbGFzc0xpc3QucmVtb3ZlKCdpbmNvcnJlY3QnKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUd1ZXNzSW5wdXQoZSkge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGlmICghZ2FtZU9uIHx8IGRvbS50ZXh0SW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA9PSAwKSByZXR1cm47XG4gIHZhciBndWVzcyA9IGRvbS50ZXh0SW5wdXQudmFsdWU7XG4gIHZlcmlmeUd1ZXNzKGd1ZXNzKTtcbiAgZG9tLmlucHV0Rm9ybS5yZXNldCgpO1xufVxuXG4vLyBNYXN0ZXIgcmVzZXQgZnVuY3Rpb25cblxuZnVuY3Rpb24gcmVzZXRHdWVzcygpIHtcbiAgZ2FtZU9uID0gZmFsc2U7XG4gIGJlc3RXaW5TdHJlYWsgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYmVzdFdpblN0cmVhaycpIHx8IDA7XG4gIGNhdGVnb3J5ID0gZ2V0UmFuZG9tQXJyYXlFbnRyeShjYXRlZ29yaWVzKTtcbiAgZG9tLmN1cnJlbnRXaW5TdHJlYWsudGV4dENvbnRlbnQgPSBjdXJyZW50V2luU3RyZWFrO1xuICBkb20uYmVzdFdpblN0cmVhay50ZXh0Q29udGVudCA9IGJlc3RXaW5TdHJlYWs7XG4gIGRvbS5jbHVlcy5pbm5lckhUTUwgPSAnJztcbiAgaW5jb3JyZWN0QW5zd2Vycy5jdXJyZW50ID0gMDtcbiAgY2xlYXJHdWVzc1Jlc3VsdHMoKTtcbiAgZG9tLmlucHV0Rm9ybS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gIGRvbS53aW5TY3JlZW4uY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICBkb20ubG9zZVNjcmVlbi5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gIGRvbS50ZXh0SW5wdXQuZm9jdXMoKTtcblxuICB2YXIgZ2V0Q2x1ZURhdGEgPSBmZXRjaCgnLi9qc29uL2NsdWVzLmpzb24nKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGpzb24pIHtcbiAgICByZXR1cm4ganNvbi5lbnRyaWVzO1xuICB9KTtcblxuICB2YXIgZ2V0Q2F0ZWdvcnlEYXRhID0gZmV0Y2goJy4vanNvbi8nICsgY2F0ZWdvcnkgKyAnLmpzb24nKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGpzb24pIHtcbiAgICByZXR1cm4ganNvbi5lbnRyaWVzO1xuICB9KTtcblxuICBQcm9taXNlLmFsbChbZ2V0Q2F0ZWdvcnlEYXRhLCBnZXRDbHVlRGF0YV0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgZG9tLmlucHV0Rm9ybS5yZXNldCgpO1xuICAgIGVudHJpZXMgPSByZXNwb25zZVswXTtcbiAgICBhbnN3ZXJPYmoudHJ1ZUFuc3dlciA9IGVudHJpZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogZW50cmllcy5sZW5ndGgpXTtcbiAgICBhbnN3ZXJPYmouc3RyaXBwZWRBbnN3ZXIgPSBhbnN3ZXJPYmoudHJ1ZUFuc3dlci5yZXBsYWNlKC9cXHMvZywgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgYWxsQ2x1ZXMgPSByZXNwb25zZVsxXTtcbiAgICBidWlsZENsdWVzKGFsbENsdWVzLCBhbnN3ZXJPYmouc3RyaXBwZWRBbnN3ZXIpO1xuICAgIHNob3dDYXRlZ29yeShjYXRlZ29yeSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBjaGVja0ZvclJlc2V0KGUpIHtcbiAgaWYgKGUua2V5Q29kZSA9PT0gMTMgJiYgIWdhbWVPbikge1xuICAgIHJlc2V0R3Vlc3MoKTtcbiAgfVxufVxuXG4vLyBBUElcblxuXG5kb20uaW5wdXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUd1ZXNzSW5wdXQpO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZ3Vlc3MnLCByZXNldEd1ZXNzKTtcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjaGVja0ZvclJlc2V0KTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xudmFyIHBsYXlncm91bmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXlncm91bmQnKTtcbnZhciBjdXJyZW50UGxheWdyb3VuZEluZGV4ID0gMDtcbnZhciBjdXJyZW50UGxheWdyb3VuZCA9IHBsYXlncm91bmRzW2N1cnJlbnRQbGF5Z3JvdW5kSW5kZXhdO1xudmFyIG5leHRQbGF5Z3JvdW5kID0gdm9pZCAwO1xudmFyIHNjcm9sbFRpbWUgPSA2MDA7XG52YXIgaXNTY3JvbGxpbmcgPSBmYWxzZTtcbnZhciBldmVudHMgPSB7fTtcblxuZnVuY3Rpb24gc2Nyb2xsSmFjayhlKSB7XG4gIC8vIElmIHNjcm9sbGluZyB1cFxuICBpZiAoaXNTY3JvbGxpbmcpIHJldHVybjtcbiAgaXNTY3JvbGxpbmcgPSB0cnVlO1xuICBpZiAoZS5kZWx0YVkgPCAwKSB7XG4gICAgY3VycmVudFBsYXlncm91bmQgPSBwbGF5Z3JvdW5kc1tjdXJyZW50UGxheWdyb3VuZEluZGV4XTtcbiAgICBpZiAoY3VycmVudFBsYXlncm91bmRJbmRleCA+IDApIHtcbiAgICAgIGN1cnJlbnRQbGF5Z3JvdW5kSW5kZXgtLTtcbiAgICB9XG4gICAgbmV4dFBsYXlncm91bmQgPSBwbGF5Z3JvdW5kc1tjdXJyZW50UGxheWdyb3VuZEluZGV4XTtcbiAgICBzY3JvbGxUb0N1cnJlbnRQbGF5Z3JvdW5kKGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICBjdXJyZW50UGxheWdyb3VuZCA9IHBsYXlncm91bmRzW2N1cnJlbnRQbGF5Z3JvdW5kSW5kZXhdO1xuICAgIGlmIChjdXJyZW50UGxheWdyb3VuZEluZGV4IDwgcGxheWdyb3VuZHMubGVuZ3RoIC0gMSkge1xuICAgICAgY3VycmVudFBsYXlncm91bmRJbmRleCsrO1xuICAgIH1cbiAgICBuZXh0UGxheWdyb3VuZCA9IHBsYXlncm91bmRzW2N1cnJlbnRQbGF5Z3JvdW5kSW5kZXhdO1xuICAgIHNjcm9sbFRvQ3VycmVudFBsYXlncm91bmQodHJ1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2Nyb2xsVG9DdXJyZW50UGxheWdyb3VuZChpc1Njcm9sbERvd24pIHtcbiAgaWYgKCFuZXh0UGxheWdyb3VuZCkgcmV0dXJuO1xuICBpZiAoaXNTY3JvbGxEb3duKSB7XG4gICAgY3VycmVudFBsYXlncm91bmQuY2xhc3NMaXN0LmFkZCgnY3VycmVudCcpO1xuICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5hZGQoJ25leHQtc2Nyb2xsaW5nJywgJ3NsaWRpbmcnKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGN1cnJlbnRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5yZW1vdmUoJ2N1cnJlbnQnKTtcbiAgICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5yZW1vdmUoJ25leHQtc2Nyb2xsaW5nJywgJ3NsaWRpbmcnKTtcbiAgICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5hZGQoJ2N1cnJlbnQnKTtcbiAgICAgIGlmIChuZXh0UGxheWdyb3VuZC5kYXRhc2V0LnBsYXlncm91bmQpIHtcbiAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChldmVudHNbbmV4dFBsYXlncm91bmQuZGF0YXNldC5wbGF5Z3JvdW5kXSk7XG4gICAgICB9XG4gICAgICBpc1Njcm9sbGluZyA9IGZhbHNlO1xuICAgIH0sIHNjcm9sbFRpbWUpO1xuICB9IGVsc2Uge1xuICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5hZGQoJ3VwJyk7XG4gICAgY3VycmVudFBsYXlncm91bmQuY2xhc3NMaXN0LnJlbW92ZSgnY3VycmVudCcpO1xuICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5yZW1vdmUoJ25leHQtc2Nyb2xsaW5nJywgJ3NsaWRpbmcnKTtcbiAgICBuZXh0UGxheWdyb3VuZC5jbGFzc0xpc3QuYWRkKCdjdXJyZW50Jyk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBuZXh0UGxheWdyb3VuZC5jbGFzc0xpc3QucmVtb3ZlKCd1cCcpO1xuICAgIH0sIDEwKTtcblxuICAgIGlmIChuZXh0UGxheWdyb3VuZC5kYXRhc2V0LnBsYXlncm91bmQpIHtcbiAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnRzW25leHRQbGF5Z3JvdW5kLmRhdGFzZXQucGxheWdyb3VuZF0pO1xuICAgIH1cbiAgICBpc1Njcm9sbGluZyA9IGZhbHNlO1xuICB9XG59XG5cbmZ1bmN0aW9uIHNldHVwQ3VzdG9tRXZlbnRzKCkge1xuICBwbGF5Z3JvdW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5Z3JvdW5kKSB7XG4gICAgaWYgKHBsYXlncm91bmQuZGF0YXNldC5wbGF5Z3JvdW5kKSB7XG4gICAgICBldmVudHNbcGxheWdyb3VuZC5kYXRhc2V0LnBsYXlncm91bmRdID0gbmV3IEV2ZW50KHBsYXlncm91bmQuZGF0YXNldC5wbGF5Z3JvdW5kKTtcbiAgICB9XG4gIH0pO1xufVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIHNjcm9sbEphY2spO1xuXG5zZXR1cEN1c3RvbUV2ZW50cygpOyJdfQ==
