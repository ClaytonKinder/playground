"use strict";function getRandomArrayEntry(e){return e[Math.floor(Math.random()*e.length)]}function buildClueHints(e,t){var n=[];return e.forEach(function(e){"beginsWith"==e.key?e.finalSentence=e.sentence+t.charAt(0).toUpperCase()+".":"endsWith"==e.key?e.finalSentence=e.sentence+t.substr(-1).toUpperCase()+".":"length"==e.key&&(e.finalSentence=e.sentence+t.length+" characters."),n.push(e.finalSentence)}),n}function buildClues(e,t){var n=[];for(n[0]=getRandomArrayEntry(e),n[1]=getRandomArrayEntry(e);n[0]===n[1];)n[1]=getRandomArrayEntry(e);chosenClues=buildClueHints(n,t)}function showCategory(e){dom.categoryText.classList.remove("chosen");var t=[].concat(categories),n={totalTime:500,totalIterations:5,currentIteration:0,catIndex:0},r=(categories.findIndex(function(t){return t===e}),setInterval(function(){n.catIndex>t.length-1&&(n.catIndex=0),n.currentIteration>n.totalIterations&&t[n.catIndex]===e&&(clearInterval(r),gameOn=!0,dom.categoryText.classList.add("chosen")),dom.categoryText.textContent=t[n.catIndex],n.currentIteration++,n.catIndex++},n.totalTime/t.length))}function handleGameOver(e){gameOn=!1,e?(dom.inputForm.classList.add("hide"),dom.winScreen.classList.remove("hide"),currentWinStreak++,dom.currentWinStreak.textContent=currentWinStreak,currentWinStreak>bestWinStreak&&localStorage.setItem("bestWinStreak",currentWinStreak)):(dom.inputForm.classList.add("hide"),dom.loseScreen.classList.remove("hide"),currentWinStreak=0)}function verifyGuess(e){(e=e.toLowerCase().replace(/\s/g,""))!==answerObj.strippedAnswer?(incorrectAnswers.current++,incorrectAnswers.current===incorrectAnswers.total?(markGuessResults(incorrectAnswers.current),handleGameOver(!1)):(markGuessResults(incorrectAnswers.current),giveClue())):(markGuessResults(incorrectAnswers.current++,!0),handleGameOver(!0))}function giveClue(){var e=document.createElement("div");e.textContent=chosenClues.splice(0,1),dom.clues.appendChild(e)}function markGuessResults(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];dom.guessResults.forEach(function(e){e.dataset.guess==incorrectAnswers.current&&(t?e.classList.add("correct"):e.classList.add("incorrect"))})}function clearGuessResults(){dom.guessResults.forEach(function(e){e.classList.remove("correct"),e.classList.remove("incorrect")})}function handleGuessInput(e){e.preventDefault(),gameOn&&0!=dom.textInput.value.trim().length&&(verifyGuess(dom.textInput.value),dom.inputForm.reset())}function resetGuess(){gameOn=!1,bestWinStreak=localStorage.getItem("bestWinStreak")||0,dom.currentWinStreak.textContent=currentWinStreak,dom.bestWinStreak.textContent=bestWinStreak,dom.clues.innerHTML="",incorrectAnswers.current=0,clearGuessResults(),dom.inputForm.classList.remove("hide"),dom.winScreen.classList.add("hide"),dom.loseScreen.classList.add("hide"),dom.textInput.focus(),Promise.all([getCategoryData,getClueData]).then(function(e){dom.inputForm.reset(),entries=e[0],answerObj.trueAnswer=entries[Math.floor(Math.random()*entries.length)],answerObj.strippedAnswer=answerObj.trueAnswer.replace(/\s/g,""),buildClues(allClues=e[1],answerObj.strippedAnswer),showCategory(category),console.log(answerObj.strippedAnswer)})}function checkForReset(e){13!==e.keyCode||gameOn||resetGuess()}var categories=["fruits","vegetables"],entries=[],answerObj={},allClues=void 0,chosenClues=[],category=getRandomArrayEntry(categories),gameOn=void 0,currentWinStreak=0,bestWinStreak=void 0,incorrectAnswers={total:3,current:0},dom={bestWinStreak:document.querySelector(".guess .best-win-streak .value"),currentWinStreak:document.querySelector(".guess .current-win-streak .value"),categoryText:document.querySelector(".guess .category-text"),inputForm:document.querySelector('.guess form[name="guess-form"]'),textInput:document.querySelector('.guess form[name="guess-form"] input[type="text"]'),guessResults:document.querySelectorAll(".guess [data-guess]"),clues:document.querySelector(".guess .clue-text"),winScreen:document.querySelector(".guess .win"),loseScreen:document.querySelector(".guess .lose")},getClueData=fetch("./json/clues.json").then(function(e){return e.json()}).then(function(e){return e.entries}),getCategoryData=fetch("./json/"+category+".json").then(function(e){return e.json()}).then(function(e){return e.entries});dom.inputForm.addEventListener("submit",handleGuessInput),document.addEventListener("guess",resetGuess),document.addEventListener("keydown",checkForReset);
"use strict";function scrollJack(n){isScrolling||(isScrolling=!0,n.deltaY<0?(currentPlayground=playgrounds[currentPlaygroundIndex],currentPlaygroundIndex>0&&currentPlaygroundIndex--,nextPlayground=playgrounds[currentPlaygroundIndex],scrollToCurrentPlayground(!1)):(currentPlayground=playgrounds[currentPlaygroundIndex],currentPlaygroundIndex<playgrounds.length-1&&currentPlaygroundIndex++,nextPlayground=playgrounds[currentPlaygroundIndex],scrollToCurrentPlayground(!0)))}function scrollToCurrentPlayground(n){nextPlayground&&(n?(currentPlayground.classList.add("current"),nextPlayground.classList.add("next-scrolling","sliding"),setTimeout(function(){currentPlayground.classList.remove("current"),nextPlayground.classList.remove("next-scrolling","sliding"),nextPlayground.classList.add("current"),nextPlayground.dataset.playground&&document.dispatchEvent(events[nextPlayground.dataset.playground]),isScrolling=!1},scrollTime)):(nextPlayground.classList.add("up"),currentPlayground.classList.remove("current"),nextPlayground.classList.remove("next-scrolling","sliding"),nextPlayground.classList.add("current"),setTimeout(function(){nextPlayground.classList.remove("up")},10),nextPlayground.dataset.playground&&document.dispatchEvent(events[nextPlayground.dataset.playground]),isScrolling=!1))}function setupCustomEvents(){playgrounds.forEach(function(n){n.dataset.playground&&(events[n.dataset.playground]=new Event(n.dataset.playground))})}var body=document.querySelector("body"),playgrounds=document.querySelectorAll(".playground"),currentPlaygroundIndex=0,currentPlayground=playgrounds[currentPlaygroundIndex],nextPlayground=void 0,scrollTime=600,isScrolling=!1,events={};document.addEventListener("wheel",scrollJack),setupCustomEvents();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImd1ZXNzLmpzIiwicGxheWdyb3VuZC5qcyJdLCJuYW1lcyI6WyJnZXRSYW5kb21BcnJheUVudHJ5IiwiYXJyYXkiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJsZW5ndGgiLCJidWlsZENsdWVIaW50cyIsImNsdWVzIiwiYW5zd2VyIiwiZmluYWxDbHVlcyIsImZvckVhY2giLCJjbHVlIiwia2V5IiwiZmluYWxTZW50ZW5jZSIsInNlbnRlbmNlIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzdWJzdHIiLCJwdXNoIiwiYnVpbGRDbHVlcyIsImFsbENsdWVzIiwidW5maW5pc2hlZENsdWVzIiwiY2hvc2VuQ2x1ZXMiLCJzaG93Q2F0ZWdvcnkiLCJjYXRlZ29yeSIsImRvbSIsImNhdGVnb3J5VGV4dCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImNhdHMiLCJjb25jYXQiLCJjYXRlZ29yaWVzIiwiaXRlcmF0aW9uIiwidG90YWxUaW1lIiwidG90YWxJdGVyYXRpb25zIiwiY3VycmVudEl0ZXJhdGlvbiIsImNhdEluZGV4IiwiY2F0ZWdvcnlJbnRlcnZhbCIsImZpbmRJbmRleCIsImNhdCIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsImdhbWVPbiIsImFkZCIsInRleHRDb250ZW50IiwiaGFuZGxlR2FtZU92ZXIiLCJ3aW4iLCJpbnB1dEZvcm0iLCJ3aW5TY3JlZW4iLCJjdXJyZW50V2luU3RyZWFrIiwiYmVzdFdpblN0cmVhayIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJsb3NlU2NyZWVuIiwidmVyaWZ5R3Vlc3MiLCJndWVzcyIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsImFuc3dlck9iaiIsInN0cmlwcGVkQW5zd2VyIiwiaW5jb3JyZWN0QW5zd2VycyIsImN1cnJlbnQiLCJ0b3RhbCIsIm1hcmtHdWVzc1Jlc3VsdHMiLCJnaXZlQ2x1ZSIsImRpdiIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInNwbGljZSIsImFwcGVuZENoaWxkIiwiY29ycmVjdCIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsImd1ZXNzUmVzdWx0cyIsInJlc3VsdCIsImRhdGFzZXQiLCJjbGVhckd1ZXNzUmVzdWx0cyIsImhhbmRsZUd1ZXNzSW5wdXQiLCJlIiwicHJldmVudERlZmF1bHQiLCJ0ZXh0SW5wdXQiLCJ2YWx1ZSIsInRyaW0iLCJyZXNldCIsInJlc2V0R3Vlc3MiLCJnZXRJdGVtIiwiaW5uZXJIVE1MIiwiZm9jdXMiLCJQcm9taXNlIiwiYWxsIiwiZ2V0Q2F0ZWdvcnlEYXRhIiwiZ2V0Q2x1ZURhdGEiLCJ0aGVuIiwicmVzcG9uc2UiLCJlbnRyaWVzIiwidHJ1ZUFuc3dlciIsImNvbnNvbGUiLCJsb2ciLCJjaGVja0ZvclJlc2V0Iiwia2V5Q29kZSIsInF1ZXJ5U2VsZWN0b3IiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZmV0Y2giLCJqc29uIiwiYWRkRXZlbnRMaXN0ZW5lciIsInNjcm9sbEphY2siLCJpc1Njcm9sbGluZyIsImRlbHRhWSIsImN1cnJlbnRQbGF5Z3JvdW5kIiwicGxheWdyb3VuZHMiLCJjdXJyZW50UGxheWdyb3VuZEluZGV4IiwibmV4dFBsYXlncm91bmQiLCJzY3JvbGxUb0N1cnJlbnRQbGF5Z3JvdW5kIiwiaXNTY3JvbGxEb3duIiwic2V0VGltZW91dCIsInBsYXlncm91bmQiLCJkaXNwYXRjaEV2ZW50IiwiZXZlbnRzIiwic2Nyb2xsVGltZSIsInNldHVwQ3VzdG9tRXZlbnRzIiwiRXZlbnQiLCJib2R5Il0sIm1hcHBpbmdzIjoiQUFBQSxhQTRCRSxTQUFTQSxvQkFBb0JDLEdBQzdCLE9BQU9BLEVBQU1DLEtBQUtDLE1BQU1ELEtBQUtFLFNBQVdILEVBQU1JLFNBS2hELFNBQVNDLGVBQWVDLEVBQU9DLEdBQzdCLElBQUlDLEtBV0osT0FWQUYsRUFBTUcsUUFBUSxTQUFVQyxHQUNOLGNBQVpBLEVBQUtDLElBQ1BELEVBQUtFLGNBQWdCRixFQUFLRyxTQUFXTixFQUFPTyxPQUFPLEdBQUdDLGNBQWdCLElBQ2pELFlBQVpMLEVBQUtDLElB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QUVIUCxlQUFlcEYsVUFBVWdCLElBQUksTUFDN0JpRSxrQkFBa0JqRixVQUFVQyxPQUFPLFdBQ25DbUYsZUFBZXBGLFVBQVVDLE9BQU8saUJBQWtCLFdBQ2xEbUYsZUFBZXBGLFVBQVVnQixJQUFJLFdBQzdCdUUsV0FBVyxXQUNUSCxlQUFlcEYsVUFBVUMsT0FBTyxPQUMvQixJQUVDbUYsZUFBZXBDLFFBQVF3QyxZQUN6QmpELFNBQVNrRCxjQUFjQyxPQUFPTixlQUFlcEMsUUFBUXdDLGFBRXZEVCxhQUFjLElBSWxCLFNBQVNhLG9CQUNQVixZQUFZbkcsUUFBUSxTQUFVeUcsR0FDeEJBLEVBQVd4QyxRQUFRd0MsYUFDckJFLE9BQU9GLEVBQVd4QyxRQUFRd0MsWUFBYyxJQUFJSyxNQUFNTCxFQUFXeEMsUUFBUXdDLGVBL0QzRSxJQUFJTSxLQUFPdkQsU0FBU2tDLGNBQWMsUUFDOUJTLFlBQWMzQyxTQUFTbUMsaUJBQWlCLGVBQ3hDUyx1QkFBeUIsRUFDekJGLGtCQUFvQkMsWUFBWUMsd0JBQ2hDQyxvQkFBaUIsRUFDakJPLFdBQWEsSUFDYlosYUFBYyxFQUNkVyxVQTZESm5ELFNBQVNzQyxpQkFBaUIsUUFBU0MsWUFFbkNjIiwiZmlsZSI6ImFsbC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBjYXRlZ29yaWVzID0gWydmcnVpdHMnLCAndmVnZXRhYmxlcyddO1xudmFyIGVudHJpZXMgPSBbXTtcbnZhciBhbnN3ZXJPYmogPSB7fTtcbnZhciBhbGxDbHVlcyA9IHZvaWQgMDtcbnZhciBjaG9zZW5DbHVlcyA9IFtdO1xudmFyIGNhdGVnb3J5ID0gZ2V0UmFuZG9tQXJyYXlFbnRyeShjYXRlZ29yaWVzKTtcbnZhciBnYW1lT24gPSB2b2lkIDA7XG52YXIgY3VycmVudFdpblN0cmVhayA9IDA7XG52YXIgYmVzdFdpblN0cmVhayA9IHZvaWQgMDtcbnZhciBpbmNvcnJlY3RBbnN3ZXJzID0ge1xuICB0b3RhbDogMyxcbiAgY3VycmVudDogMFxufTtcblxudmFyIGRvbSA9IHtcbiAgYmVzdFdpblN0cmVhazogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmd1ZXNzIC5iZXN0LXdpbi1zdHJlYWsgLnZhbHVlJyksXG4gIGN1cnJlbnRXaW5TdHJlYWs6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ndWVzcyAuY3VycmVudC13aW4tc3RyZWFrIC52YWx1ZScpLFxuICBjYXRlZ29yeVRleHQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ndWVzcyAuY2F0ZWdvcnktdGV4dCcpLFxuICBpbnB1dEZvcm06IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ndWVzcyBmb3JtW25hbWU9XCJndWVzcy1mb3JtXCJdJyksXG4gIHRleHRJbnB1dDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmd1ZXNzIGZvcm1bbmFtZT1cImd1ZXNzLWZvcm1cIl0gaW5wdXRbdHlwZT1cInRleHRcIl0nKSxcbiAgZ3Vlc3NSZXN1bHRzOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ3Vlc3MgW2RhdGEtZ3Vlc3NdJyksXG4gIGNsdWVzOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ3Vlc3MgLmNsdWUtdGV4dCcpLFxuICB3aW5TY3JlZW46IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ndWVzcyAud2luJyksXG4gIGxvc2VTY3JlZW46IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ndWVzcyAubG9zZScpXG4gIC8vIFV0aWxpdHkgZnVuY3Rpb25zXG5cbn07ZnVuY3Rpb24gZ2V0UmFuZG9tQXJyYXlFbnRyeShhcnJheSkge1xuICByZXR1cm4gYXJyYXlbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYXJyYXkubGVuZ3RoKV07XG59XG5cbi8vIENsdWUgZnVuY3Rpb25zXG5cbmZ1bmN0aW9uIGJ1aWxkQ2x1ZUhpbnRzKGNsdWVzLCBhbnN3ZXIpIHtcbiAgdmFyIGZpbmFsQ2x1ZXMgPSBbXTtcbiAgY2x1ZXMuZm9yRWFjaChmdW5jdGlvbiAoY2x1ZSkge1xuICAgIGlmIChjbHVlLmtleSA9PSAnYmVnaW5zV2l0aCcpIHtcbiAgICAgIGNsdWUuZmluYWxTZW50ZW5jZSA9IGNsdWUuc2VudGVuY2UgKyBhbnN3ZXIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyAnLic7XG4gICAgfSBlbHNlIGlmIChjbHVlLmtleSA9PSAnZW5kc1dpdGgnKSB7XG4gICAgICBjbHVlLmZpbmFsU2VudGVuY2UgPSBjbHVlLnNlbnRlbmNlICsgYW5zd2VyLnN1YnN0cigtMSkudG9VcHBlckNhc2UoKSArICcuJztcbiAgICB9IGVsc2UgaWYgKGNsdWUua2V5ID09ICdsZW5ndGgnKSB7XG4gICAgICBjbHVlLmZpbmFsU2VudGVuY2UgPSBjbHVlLnNlbnRlbmNlICsgYW5zd2VyLmxlbmd0aCArICcgY2hhcmFjdGVycy4nO1xuICAgIH1cbiAgICBmaW5hbENsdWVzLnB1c2goY2x1ZS5maW5hbFNlbnRlbmNlKTtcbiAgfSk7XG4gIHJldHVybiBmaW5hbENsdWVzO1xufVxuXG5mdW5jdGlvbiBidWlsZENsdWVzKGFsbENsdWVzLCBhbnN3ZXIpIHtcbiAgdmFyIHVuZmluaXNoZWRDbHVlcyA9IFtdO1xuICB1bmZpbmlzaGVkQ2x1ZXNbMF0gPSBnZXRSYW5kb21BcnJheUVudHJ5KGFsbENsdWVzKTtcbiAgdW5maW5pc2hlZENsdWVzWzFdID0gZ2V0UmFuZG9tQXJyYXlFbnRyeShhbGxDbHVlcyk7XG4gIHdoaWxlICh1bmZpbmlzaGVkQ2x1ZXNbMF0gPT09IHVuZmluaXNoZWRDbHVlc1sxXSkge1xuICAgIHVuZmluaXNoZWRDbHVlc1sxXSA9IGdldFJhbmRvbUFycmF5RW50cnkoYWxsQ2x1ZXMpO1xuICB9XG4gIGNob3NlbkNsdWVzID0gYnVpbGRDbHVlSGludHModW5maW5pc2hlZENsdWVzLCBhbnN3ZXIpO1xufVxuXG4vLyBDYXRlZ29yeSBmdW5jdGlvbnNcbmZ1bmN0aW9uIHNob3dDYXRlZ29yeShjYXRlZ29yeSkge1xuICBkb20uY2F0ZWdvcnlUZXh0LmNsYXNzTGlzdC5yZW1vdmUoJ2Nob3NlbicpO1xuICB2YXIgY2F0cyA9IFtdLmNvbmNhdChjYXRlZ29yaWVzKTtcbiAgdmFyIGl0ZXJhdGlvbiA9IHtcbiAgICB0b3RhbFRpbWU6IDUwMCxcbiAgICB0b3RhbEl0ZXJhdGlvbnM6IDUsXG4gICAgY3VycmVudEl0ZXJhdGlvbjogMCxcbiAgICBjYXRJbmRleDogMFxuICB9O1xuICB2YXIgZmluYWxDYXRlZ29yeUluZGV4ID0gY2F0ZWdvcmllcy5maW5kSW5kZXgoZnVuY3Rpb24gKGNhdCkge1xuICAgIHJldHVybiBjYXQgPT09IGNhdGVnb3J5O1xuICB9KTtcbiAgdmFyIGNhdGVnb3J5SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGl0ZXJhdGlvbi5jYXRJbmRleCA+IGNhdHMubGVuZ3RoIC0gMSkge1xuICAgICAgaXRlcmF0aW9uLmNhdEluZGV4ID0gMDtcbiAgICB9XG4gICAgaWYgKGl0ZXJhdGlvbi5jdXJyZW50SXRlcmF0aW9uID4gaXRlcmF0aW9uLnRvdGFsSXRlcmF0aW9ucykge1xuICAgICAgaWYgKGNhdHNbaXRlcmF0aW9uLmNhdEluZGV4XSA9PT0gY2F0ZWdvcnkpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChjYXRlZ29yeUludGVydmFsKTtcbiAgICAgICAgZ2FtZU9uID0gdHJ1ZTtcbiAgICAgICAgZG9tLmNhdGVnb3J5VGV4dC5jbGFzc0xpc3QuYWRkKCdjaG9zZW4nKTtcbiAgICAgIH1cbiAgICB9XG4gICAgZG9tLmNhdGVnb3J5VGV4dC50ZXh0Q29udGVudCA9IGNhdHNbaXRlcmF0aW9uLmNhdEluZGV4XTtcbiAgICBpdGVyYXRpb24uY3VycmVudEl0ZXJhdGlvbisrO1xuICAgIGl0ZXJhdGlvbi5jYXRJbmRleCsrO1xuICB9LCBpdGVyYXRpb24udG90YWxUaW1lIC8gY2F0cy5sZW5ndGgpO1xufVxuXG4vLyBJbnB1dFxuXG5mdW5jdGlvbiBoYW5kbGVHYW1lT3Zlcih3aW4pIHtcbiAgZ2FtZU9uID0gZmFsc2U7XG4gIGlmICh3aW4pIHtcbiAgICBkb20uaW5wdXRGb3JtLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcbiAgICBkb20ud2luU2NyZWVuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcbiAgICBjdXJyZW50V2luU3RyZWFrKys7XG4gICAgZG9tLmN1cnJlbnRXaW5TdHJlYWsudGV4dENvbnRlbnQgPSBjdXJyZW50V2luU3RyZWFrO1xuICAgIGlmIChjdXJyZW50V2luU3RyZWFrID4gYmVzdFdpblN0cmVhaykge1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Jlc3RXaW5TdHJlYWsnLCBjdXJyZW50V2luU3RyZWFrKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZG9tLmlucHV0Rm9ybS5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gICAgZG9tLmxvc2VTY3JlZW4uY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xuICAgIGN1cnJlbnRXaW5TdHJlYWsgPSAwO1xuICB9XG59XG5cbmZ1bmN0aW9uIHZlcmlmeUd1ZXNzKGd1ZXNzKSB7XG4gIGd1ZXNzID0gZ3Vlc3MudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9cXHMvZywgJycpO1xuICAvLyBJZiBndWVzcyBpcyBpbmNvcnJlY3RcbiAgaWYgKGd1ZXNzICE9PSBhbnN3ZXJPYmouc3RyaXBwZWRBbnN3ZXIpIHtcbiAgICBpbmNvcnJlY3RBbnN3ZXJzLmN1cnJlbnQrKztcbiAgICAvLyBJZiB1c2VyIGhhcyBlbm91Z2ggaW5jb3JyZWN0IGd1ZXNzZXMgZm9yIGEgZ2FtZSBvdmVyXG4gICAgaWYgKGluY29ycmVjdEFuc3dlcnMuY3VycmVudCA9PT0gaW5jb3JyZWN0QW5zd2Vycy50b3RhbCkge1xuICAgICAgbWFya0d1ZXNzUmVzdWx0cyhpbmNvcnJlY3RBbnN3ZXJzLmN1cnJlbnQpO1xuICAgICAgaGFuZGxlR2FtZU92ZXIoZmFsc2UpO1xuICAgICAgLy8gSWYgdXNlciBkb2VzIE5PVCBoYXZlIGVub3VnaCBpbmNvcnJlY3QgZ3Vlc3NlcyBmb3IgYSBnYW1lIG92ZXJcbiAgICB9IGVsc2Uge1xuICAgICAgbWFya0d1ZXNzUmVzdWx0cyhpbmNvcnJlY3RBbnN3ZXJzLmN1cnJlbnQpO1xuICAgICAgZ2l2ZUNsdWUoKTtcbiAgICB9XG4gICAgLy8gSWYgZ3Vlc3MgaXMgY29ycmVjdFxuICB9IGVsc2Uge1xuICAgIG1hcmtHdWVzc1Jlc3VsdHMoaW5jb3JyZWN0QW5zd2Vycy5jdXJyZW50KyssIHRydWUpO1xuICAgIGhhbmRsZUdhbWVPdmVyKHRydWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdpdmVDbHVlKCkge1xuICB2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGRpdi50ZXh0Q29udGVudCA9IGNob3NlbkNsdWVzLnNwbGljZSgwLCAxKTtcbiAgZG9tLmNsdWVzLmFwcGVuZENoaWxkKGRpdik7XG59XG5cbmZ1bmN0aW9uIG1hcmtHdWVzc1Jlc3VsdHMoY3VycmVudCkge1xuICB2YXIgY29ycmVjdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7XG5cbiAgZG9tLmd1ZXNzUmVzdWx0cy5mb3JFYWNoKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICBpZiAocmVzdWx0LmRhdGFzZXQuZ3Vlc3MgPT0gaW5jb3JyZWN0QW5zd2Vycy5jdXJyZW50KSB7XG4gICAgICBpZiAoY29ycmVjdCkge1xuICAgICAgICByZXN1bHQuY2xhc3NMaXN0LmFkZCgnY29ycmVjdCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0LmNsYXNzTGlzdC5hZGQoJ2luY29ycmVjdCcpO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGNsZWFyR3Vlc3NSZXN1bHRzKCkge1xuICBkb20uZ3Vlc3NSZXN1bHRzLmZvckVhY2goZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgIHJlc3VsdC5jbGFzc0xpc3QucmVtb3ZlKCdjb3JyZWN0Jyk7XG4gICAgcmVzdWx0LmNsYXNzTGlzdC5yZW1vdmUoJ2luY29ycmVjdCcpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlR3Vlc3NJbnB1dChlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgaWYgKCFnYW1lT24gfHwgZG9tLnRleHRJbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoID09IDApIHJldHVybjtcbiAgdmFyIGd1ZXNzID0gZG9tLnRleHRJbnB1dC52YWx1ZTtcbiAgdmVyaWZ5R3Vlc3MoZ3Vlc3MpO1xuICBkb20uaW5wdXRGb3JtLnJlc2V0KCk7XG59XG5cbi8vIE1hc3RlciByZXNldCBmdW5jdGlvblxuXG5mdW5jdGlvbiByZXNldEd1ZXNzKCkge1xuICBnYW1lT24gPSBmYWxzZTtcbiAgYmVzdFdpblN0cmVhayA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdiZXN0V2luU3RyZWFrJykgfHwgMDtcbiAgZG9tLmN1cnJlbnRXaW5TdHJlYWsudGV4dENvbnRlbnQgPSBjdXJyZW50V2luU3RyZWFrO1xuICBkb20uYmVzdFdpblN0cmVhay50ZXh0Q29udGVudCA9IGJlc3RXaW5TdHJlYWs7XG4gIGRvbS5jbHVlcy5pbm5lckhUTUwgPSAnJztcbiAgaW5jb3JyZWN0QW5zd2Vycy5jdXJyZW50ID0gMDtcbiAgY2xlYXJHdWVzc1Jlc3VsdHMoKTtcbiAgZG9tLmlucHV0Rm9ybS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XG4gIGRvbS53aW5TY3JlZW4uY2xhc3NMaXN0LmFkZCgnaGlkZScpO1xuICBkb20ubG9zZVNjcmVlbi5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XG4gIGRvbS50ZXh0SW5wdXQuZm9jdXMoKTtcbiAgUHJvbWlzZS5hbGwoW2dldENhdGVnb3J5RGF0YSwgZ2V0Q2x1ZURhdGFdKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIGRvbS5pbnB1dEZvcm0ucmVzZXQoKTtcbiAgICBlbnRyaWVzID0gcmVzcG9uc2VbMF07XG4gICAgYW5zd2VyT2JqLnRydWVBbnN3ZXIgPSBlbnRyaWVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGVudHJpZXMubGVuZ3RoKV07XG4gICAgYW5zd2VyT2JqLnN0cmlwcGVkQW5zd2VyID0gYW5zd2VyT2JqLnRydWVBbnN3ZXIucmVwbGFjZSgvXFxzL2csICcnKTtcbiAgICBhbGxDbHVlcyA9IHJlc3BvbnNlWzFdO1xuICAgIGJ1aWxkQ2x1ZXMoYWxsQ2x1ZXMsIGFuc3dlck9iai5zdHJpcHBlZEFuc3dlcik7XG4gICAgc2hvd0NhdGVnb3J5KGNhdGVnb3J5KTtcbiAgICBjb25zb2xlLmxvZyhhbnN3ZXJPYmouc3RyaXBwZWRBbnN3ZXIpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gY2hlY2tGb3JSZXNldChlKSB7XG4gIGlmIChlLmtleUNvZGUgPT09IDEzICYmICFnYW1lT24pIHtcbiAgICByZXNldEd1ZXNzKCk7XG4gIH1cbn1cblxuLy8gQVBJXG5cbnZhciBnZXRDbHVlRGF0YSA9IGZldGNoKCcuL2pzb24vY2x1ZXMuanNvbicpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59KS50aGVuKGZ1bmN0aW9uIChqc29uKSB7XG4gIHJldHVybiBqc29uLmVudHJpZXM7XG59KTtcblxudmFyIGdldENhdGVnb3J5RGF0YSA9IGZldGNoKCcuL2pzb24vJyArIGNhdGVnb3J5ICsgJy5qc29uJykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbn0pLnRoZW4oZnVuY3Rpb24gKGpzb24pIHtcbiAgcmV0dXJuIGpzb24uZW50cmllcztcbn0pO1xuXG5kb20uaW5wdXRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZUd1ZXNzSW5wdXQpO1xuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZ3Vlc3MnLCByZXNldEd1ZXNzKTtcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBjaGVja0ZvclJlc2V0KTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xudmFyIHBsYXlncm91bmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXlncm91bmQnKTtcbnZhciBjdXJyZW50UGxheWdyb3VuZEluZGV4ID0gMDtcbnZhciBjdXJyZW50UGxheWdyb3VuZCA9IHBsYXlncm91bmRzW2N1cnJlbnRQbGF5Z3JvdW5kSW5kZXhdO1xudmFyIG5leHRQbGF5Z3JvdW5kID0gdm9pZCAwO1xudmFyIHNjcm9sbFRpbWUgPSA2MDA7XG52YXIgaXNTY3JvbGxpbmcgPSBmYWxzZTtcbnZhciBldmVudHMgPSB7fTtcblxuZnVuY3Rpb24gc2Nyb2xsSmFjayhlKSB7XG4gIC8vIElmIHNjcm9sbGluZyB1cFxuICBpZiAoaXNTY3JvbGxpbmcpIHJldHVybjtcbiAgaXNTY3JvbGxpbmcgPSB0cnVlO1xuICBpZiAoZS5kZWx0YVkgPCAwKSB7XG4gICAgY3VycmVudFBsYXlncm91bmQgPSBwbGF5Z3JvdW5kc1tjdXJyZW50UGxheWdyb3VuZEluZGV4XTtcbiAgICBpZiAoY3VycmVudFBsYXlncm91bmRJbmRleCA+IDApIHtcbiAgICAgIGN1cnJlbnRQbGF5Z3JvdW5kSW5kZXgtLTtcbiAgICB9XG4gICAgbmV4dFBsYXlncm91bmQgPSBwbGF5Z3JvdW5kc1tjdXJyZW50UGxheWdyb3VuZEluZGV4XTtcbiAgICBzY3JvbGxUb0N1cnJlbnRQbGF5Z3JvdW5kKGZhbHNlKTtcbiAgfSBlbHNlIHtcbiAgICBjdXJyZW50UGxheWdyb3VuZCA9IHBsYXlncm91bmRzW2N1cnJlbnRQbGF5Z3JvdW5kSW5kZXhdO1xuICAgIGlmIChjdXJyZW50UGxheWdyb3VuZEluZGV4IDwgcGxheWdyb3VuZHMubGVuZ3RoIC0gMSkge1xuICAgICAgY3VycmVudFBsYXlncm91bmRJbmRleCsrO1xuICAgIH1cbiAgICBuZXh0UGxheWdyb3VuZCA9IHBsYXlncm91bmRzW2N1cnJlbnRQbGF5Z3JvdW5kSW5kZXhdO1xuICAgIHNjcm9sbFRvQ3VycmVudFBsYXlncm91bmQodHJ1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2Nyb2xsVG9DdXJyZW50UGxheWdyb3VuZChpc1Njcm9sbERvd24pIHtcbiAgaWYgKCFuZXh0UGxheWdyb3VuZCkgcmV0dXJuO1xuICBpZiAoaXNTY3JvbGxEb3duKSB7XG4gICAgY3VycmVudFBsYXlncm91bmQuY2xhc3NMaXN0LmFkZCgnY3VycmVudCcpO1xuICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5hZGQoJ25leHQtc2Nyb2xsaW5nJywgJ3NsaWRpbmcnKTtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIGN1cnJlbnRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5yZW1vdmUoJ2N1cnJlbnQnKTtcbiAgICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5yZW1vdmUoJ25leHQtc2Nyb2xsaW5nJywgJ3NsaWRpbmcnKTtcbiAgICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5hZGQoJ2N1cnJlbnQnKTtcbiAgICAgIGlmIChuZXh0UGxheWdyb3VuZC5kYXRhc2V0LnBsYXlncm91bmQpIHtcbiAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChldmVudHNbbmV4dFBsYXlncm91bmQuZGF0YXNldC5wbGF5Z3JvdW5kXSk7XG4gICAgICB9XG4gICAgICBpc1Njcm9sbGluZyA9IGZhbHNlO1xuICAgIH0sIHNjcm9sbFRpbWUpO1xuICB9IGVsc2Uge1xuICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5hZGQoJ3VwJyk7XG4gICAgY3VycmVudFBsYXlncm91bmQuY2xhc3NMaXN0LnJlbW92ZSgnY3VycmVudCcpO1xuICAgIG5leHRQbGF5Z3JvdW5kLmNsYXNzTGlzdC5yZW1vdmUoJ25leHQtc2Nyb2xsaW5nJywgJ3NsaWRpbmcnKTtcbiAgICBuZXh0UGxheWdyb3VuZC5jbGFzc0xpc3QuYWRkKCdjdXJyZW50Jyk7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBuZXh0UGxheWdyb3VuZC5jbGFzc0xpc3QucmVtb3ZlKCd1cCcpO1xuICAgIH0sIDEwKTtcblxuICAgIGlmIChuZXh0UGxheWdyb3VuZC5kYXRhc2V0LnBsYXlncm91bmQpIHtcbiAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnRzW25leHRQbGF5Z3JvdW5kLmRhdGFzZXQucGxheWdyb3VuZF0pO1xuICAgIH1cbiAgICBpc1Njcm9sbGluZyA9IGZhbHNlO1xuICB9XG59XG5cbmZ1bmN0aW9uIHNldHVwQ3VzdG9tRXZlbnRzKCkge1xuICBwbGF5Z3JvdW5kcy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5Z3JvdW5kKSB7XG4gICAgaWYgKHBsYXlncm91bmQuZGF0YXNldC5wbGF5Z3JvdW5kKSB7XG4gICAgICBldmVudHNbcGxheWdyb3VuZC5kYXRhc2V0LnBsYXlncm91bmRdID0gbmV3IEV2ZW50KHBsYXlncm91bmQuZGF0YXNldC5wbGF5Z3JvdW5kKTtcbiAgICB9XG4gIH0pO1xufVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIHNjcm9sbEphY2spO1xuXG5zZXR1cEN1c3RvbUV2ZW50cygpOyJdfQ==
